See the implementation in algorithms.hpp.